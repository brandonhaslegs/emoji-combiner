function svg_to_node(e){return(new DOMParser).parseFromString(e,"text/xml").documentElement}async function fetch_parts_data(){var e=await fetch("/static/parts_data.json");return await e.json()}function fetch_svg(e,t){window.open(window.location.origin+"/save_svg/"+e,"_blank")}function fetch_png(e,t){t.preventDefault(),window.open(window.location.origin+"/save_png/"+e,"_blank")}const rand_el=e=>e[Math.floor(Math.random()*e.length)],wrap_svg=(e,t=100,o=100)=>`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 ${t} ${t}" width="${o}" height="${o}">${e}</svg>`;function generate_random_emoji_svg_node(e){var t="",o="";Object.keys(e).forEach(n=>{var r=rand_el(Object.keys(e[n])),i=e[n][r];o+=r+"-",t+=i}),o=o.substr(0,o.length-1);var n=svg_to_node(t=wrap_svg(t));return n.onclick=fetch_svg.bind(this,o),n.oncontextmenu=fetch_png.bind(this,o),n}function load_on_scroll(e,t){t.target.scrollHeight-t.target.scrollTop<=window.innerHeight+600&&load_emoji_to_DOM(t.target,e,100)}function load_emoji_to_DOM(e,t,o){for(var n=0;n<o;n++){var r=generate_random_emoji_svg_node(t);e.appendChild(r)}}function clear_el(e){for(;e.firstChild;)e.removeChild(e.firstChild)}function get_filtered_parts(e,t){var o={};return Object.keys(t).forEach(n=>{o[n]={},t[n].forEach(t=>{o[n][t]=e[n][t]})}),o}function toggle_filter(e,t,o,n,r){var i=o[n].findIndex(e=>e==r);-1==i?(o[n].push(r),e.style.background="none"):(o[n]=o[n].slice(0,i).concat(o[n].slice(i+1)),e.style.background="red");var a=get_filtered_parts(t,o),l=document.querySelector("#emoji-container");clear_el(l),load_emoji_to_DOM(l,a,200)}function render_filter_options(e,t,o,n){clear_el(e),Object.keys(o[n]).forEach(r=>{var i=o[n][r],a=wrap_svg(i,100,50);a=svg_to_node(a),-1==t[n].findIndex(e=>e==r)&&(a.style.background="red"),a.onclick=toggle_filter.bind(this,a,o,t,n,r),e.appendChild(a)})}var randomise=()=>{};(async()=>{var e=await fetch_parts_data(),t=document.querySelector("#emoji-container");load_emoji_to_DOM(t,e,200);var o={};Object.keys(e).forEach(t=>{o[t]=Object.keys(e[t])}),t.onscroll=t=>load_on_scroll(get_filtered_parts(e,o),t),randomise=()=>{t.childElementCount>=600?window.location.reload(!1):(clear_el(t),load_emoji_to_DOM(t,get_filtered_parts(e,o),100))};var n=document.getElementById("filter-options");document.getElementById("bases-filter").onclick=()=>render_filter_options(n,o,e,"bases"),document.getElementById("eyes-filter").onclick=()=>render_filter_options(n,o,e,"eyes"),document.getElementById("mouth-filter").onclick=()=>render_filter_options(n,o,e,"mouth"),document.getElementById("brows-filter").onclick=()=>render_filter_options(n,o,e,"brows"),document.getElementById("extras-filter").onclick=()=>render_filter_options(n,o,e,"extras")})();